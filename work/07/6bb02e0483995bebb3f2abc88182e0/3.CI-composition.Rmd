---
title: "CI Computation (Jeffreys Prior Beta(0.5,0.5))"
author: "Miguel Ramon"
date: "`r Sys.Date()`"
output:
html_document: default
pdf_document: default
---

# Computing Credibility Intervals for Malignant and Neoplasia Prevalence
This script computes 95% credibility intervals (CIs) for malignant and neoplasia prevalence in primate species using the Jeffreys prior Beta(0.5,0.5). It prepares data for pairwise comparisons and visualizations.

## Setup and Directory Configuration
This section configures the working environment, sets directories, and loads necessary functions and libraries.

```{r setup, message=FALSE, warning=FALSE}

# Suppress warnings and messages in output
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Set the root directory for the project
knitr::opts_knit$set(root.dir = "/home/miguel/IBE-UPF/PhD/NEOPLASY_PRIMATES")
# Display current working directory
getwd()
# Set seed for reproducibility
set.seed(1998)

```

```{r dirdef, message=FALSE, warning=FALSE}

# Define working, data, and results directories
workingDir <- getwd()
dataDir <- file.path(workingDir, "Data")
resultsDir <- file.path(workingDir, "Malignancy_Primates/Out")

# Load libraries, common functions, primate-specific functions and objects
source(file.path(workingDir, "Malignancy_Primates/Scripts/functions/libraries.R"))
source(file.path(workingDir, "Malignancy_Primates/Scripts/functions/commons.R"))
source(file.path(workingDir, "Malignancy_Primates/Scripts/functions/primate_functions.R"))
source(file.path(workingDir, "Malignancy_Primates/Scripts/functions/primate_objects.R"))

# Note that all variables may be changed from COMMONS and PRIMATE_OBJECTS scripts.

```

## 1.Confidence Interval Computation
Calculate 95% confidence intervals (CIs) for malignant and neoplasia prevalence per species.

Details:

    Uses the Wilson score method from BinomCI() in fastR2, suitable for small samples.
    CIs are computed for each species based on counts of malignant cases and necropsies.
    Results are saved as a CSV file for later use.
    
    We test for two methods of CI computation:
      - Wilson score method (BinomCI from fastR2). This method is suitable for small samples and is recommended for binomial proportions. It uses a frequentist approach.
      - Jeffreys beta method (binom.confint from binom package). This method is a Bayesian approach that uses a Jeffreys prior Beta(0.5,0.5) for binomial proportions. It is often used for small sample sizes and provides a robust estimate of the credibility interval.

```{r compute_CI}

# 1. CREDIBILITY INTERVALS COMPUTATION  ------------------------------------------------------
# Define the output directory for CI-related results
ci_dir <- file.path(trait_dir, "CIs")
createDir(ci_dir)

# Load processed cancer traits data with longevity quotient (LQ)
cancer_traits_processed <- read.csv(file.path(trait_dir, "cancer_traits_processed-LQ.csv"))

# Compute 95% confidence intervals for cancer prevalence
# - Group data by species and calculate CIs using the Wilson score method
cancer_traits_ci <- cancer_traits_processed %>%
  group_by(species) %>%
  mutate(
    # Malignant prevalence CI using Wilson's CI method
    malignant_CI_lb.wil = BinomCI(malignant_count, adult_necropsy_count, conf.level = 0.95, method = "wilson", rand = 1998)[2],
    malignant_CI_ub.wil = BinomCI(malignant_count, adult_necropsy_count, conf.level = 0.95, method = "wilson", rand = 1998)[3],
    malignant_CI.wil = paste0("[", round(malignant_CI_lb.wil, 2), "-", round(malignant_CI_ub.wil, 2), "]"),
    # Neoplasia prevalence CI using Wilson's CI method
    neoplasia_CI_lb.wil = BinomCI(neoplasia_necropsy, adult_necropsy_count, conf.level = 0.95, method = "wilson", rand = 1998)[2],
    neoplasia_CI_ub.wil = BinomCI(neoplasia_necropsy, adult_necropsy_count, conf.level = 0.95, method = "wilson", rand = 1998)[3],
    neoplasia_CI.wil = paste0("[", round(neoplasia_CI_lb.wil, 2), "-", round(neoplasia_CI_ub.wil, 2), "]")
  ) %>%
  # Jeffreys beta (bayesian) CI. Using a Jeffreys prior Beta(0.5,0.5)
  mutate(
    malignant_CI_lb.jeff = binom.confint(malignant_count, adult_necropsy_count, method = "bayes", priors=c(0.5,0.5), conf.level=0.95)[, 5],
    malignant_CI_ub.jeff = binom.confint(malignant_count, adult_necropsy_count, method = "bayes", priors=c(0.5,0.5), conf.level=0.95)[, 6],
    malignant_CI.jeff = paste0("[", round(malignant_CI_lb.jeff, 2), "-", round(malignant_CI_ub.jeff, 2), "]"),
    neoplasia_CI_lb.jeff = binom.confint(neoplasia_necropsy, adult_necropsy_count, method = "bayes", priors=c(0.5,0.5), conf.level=0.95)[, 5],
    neoplasia_CI_ub.jeff = binom.confint(neoplasia_necropsy, adult_necropsy_count, method = "bayes", priors=c(0.5,0.5), conf.level=0.95)[, 6],
    neoplasia_CI.jeff = paste0("[", round(neoplasia_CI_lb.jeff, 2), "-", round(neoplasia_CI_ub.jeff, 2), "]")
  )

write.csv(cancer_traits_ci, file.path(ci_dir, "cancer_traits_CI-jeff.csv"), quote = FALSE, row.names = FALSE)

# Excerpt for testing
head(cancer_traits_ci)

```


## 2.Pairwise Comparison Preparation
Prepare data for comparing cancer prevalence between all pairs of species.

Details:

    Selects relevant columns and creates all possible species pairs.
    Calculates differences in prevalence and checks for CI overlap.
    Assigns differences to matrix triangles (malignant in upper-left, neoplasia in lower-right).
    Saves the pairwise data for reuse.
    
```{r prep_CI, paged.print=TRUE}

# 2. PAIRWISE COMPARISON PREPARATION ------------------------------------------------------
# Select key columns for pairwise comparison
cancer_traits_diff <- cancer_traits_ci %>%
  select(species, adult_necropsy_count, 
        malignant_count, malignant_prevalence, malignant_CI_lb.wil, malignant_CI_ub.wil,
        malignant_CI_lb.jeff, malignant_CI_ub.jeff, neoplasia_necropsy, neoplasia_prevalence,
        neoplasia_CI_lb.wil, neoplasia_CI_ub.wil, neoplasia_CI_lb.jeff, neoplasia_CI_ub.jeff)

# Generate all pairwise species combinations
pairwise_data <- expand.grid(species1 = cancer_traits_diff$species,
                             species2 = cancer_traits_diff$species,
                             stringsAsFactors = FALSE)

# Merge species data for each pair
pairwise_data <- pairwise_data %>%
  left_join(cancer_traits_diff %>% rename_with(~paste0(.x, "1"), .cols = -species),
            by = c("species1" = "species")) %>%
  left_join(cancer_traits_diff %>% rename_with(~paste0(.x, "2"), .cols = -species),
            by = c("species2" = "species"))

# Calculate differences and CI overlaps
pairwise_data.wil <- pairwise_data %>%
  select(species1, species2,
         malignant_prevalence1 = malignant_prevalence1,
         malignant_prevalence2 = malignant_prevalence2,
         neoplasia_prevalence1 = neoplasia_prevalence1,
         neoplasia_prevalence2 = neoplasia_prevalence2,
         malignant_CI_lb.wil1, malignant_CI_ub.wil1, malignant_CI_lb.wil2, malignant_CI_ub.wil2,
         neoplasia_CI_lb.wil1, neoplasia_CI_ub.wil1, neoplasia_CI_lb.wil2, neoplasia_CI_ub.wil2) %>%
  mutate(
    malignant_diff = malignant_prevalence1 - malignant_prevalence2,
    neoplasia_diff = neoplasia_prevalence1 - neoplasia_prevalence2,
    malignant_overlap = (malignant_CI_lb.wil1 <= malignant_CI_ub.wil2) & (malignant_CI_lb.wil2 <= malignant_CI_ub.wil1),
    neoplasia_overlap = (neoplasia_CI_lb.wil1 <= neoplasia_CI_ub.wil2) & (neoplasia_CI_lb.wil2 <= neoplasia_CI_ub.wil1)
  ) %>%
    mutate(
    triangle = case_when(
      species1 < species2 ~ "malignant",
      species1 > species2 ~ "neoplasia",
      TRUE ~ NA_character_
    ),
    diff_value = case_when(
      triangle == "malignant" ~ malignant_diff,
      triangle == "neoplasia" ~ neoplasia_diff,
      TRUE ~ NA_real_
    ),
    overlap_use = case_when(
      triangle == "malignant" ~ malignant_overlap,
      triangle == "neoplasia" ~ neoplasia_overlap,
      TRUE ~ FALSE
    )
  )

pairwise_data.jeff <- pairwise_data %>%
  select(species1, species2,
         malignant_prevalence1 = malignant_prevalence1,
         malignant_prevalence2 = malignant_prevalence2,
         neoplasia_prevalence1 = neoplasia_prevalence1,
         neoplasia_prevalence2 = neoplasia_prevalence2,
         malignant_CI_lb.jeff1, malignant_CI_ub.jeff1, malignant_CI_lb.jeff2, malignant_CI_ub.jeff2,
         neoplasia_CI_lb.jeff1, neoplasia_CI_ub.jeff1, neoplasia_CI_lb.jeff2, neoplasia_CI_ub.jeff2) %>%
  mutate(
    malignant_diff = malignant_prevalence1 - malignant_prevalence2,
    neoplasia_diff = neoplasia_prevalence1 - neoplasia_prevalence2,
    malignant_overlap = (malignant_CI_lb.jeff1 <= malignant_CI_ub.jeff2) & (malignant_CI_lb.jeff2 <= malignant_CI_ub.jeff1),
    neoplasia_overlap = (neoplasia_CI_lb.jeff1 <= neoplasia_CI_ub.jeff2) & (neoplasia_CI_lb.jeff2 <= neoplasia_CI_ub.jeff1)
  ) %>%
    mutate(
    triangle = case_when(
      species1 < species2 ~ "malignant",
      species1 > species2 ~ "neoplasia",
      TRUE ~ NA_character_
    ),
    diff_value = case_when(
      triangle == "malignant" ~ malignant_diff,
      triangle == "neoplasia" ~ neoplasia_diff,
      TRUE ~ NA_real_
    ),
    overlap_use = case_when(
      triangle == "malignant" ~ malignant_overlap,
      triangle == "neoplasia" ~ neoplasia_overlap,
      TRUE ~ FALSE
    )
  )

# Save pairwise data for later use
write.csv(pairwise_data.wil, file.path(ci_dir, "pairwise_data-wil.csv"), quote = FALSE, row.names = FALSE)
write.csv(pairwise_data.jeff, file.path(ci_dir, "pairwise_data-jeff.csv"), quote = FALSE, row.names = FALSE)

# Excerpt for testing
head(pairwise_data.wil)
head(pairwise_data.jeff)

```

## 3.Difference Matrix Creation
Transform pairwise data into a matrix format for visualization.

Details:

    Reshapes data into a wide format with species as rows and columns.
    Converts the data frame to a matrix and saves it.

```{r diff_matrix, paged.print=TRUE}

# 3. DIFFERENCE MATRIX CREATION ------------------------------------------------------
# Reshape pairwise data into a matrix
matrix_build <- function(x) {
  x %>%
    select(species1, species2, diff_value) %>%
    pivot_wider(names_from = species2, values_from = diff_value) %>%
    column_to_rownames("species1")
  
  diff_matrix <- as.matrix(x)
}

matrix.wil <- matrix_build(pairwise_data.wil)
matrix.jeff <- matrix_build(pairwise_data.jeff)

# Convert to a matrix object

# Save the difference matrix
write.csv(matrix.wil, file.path(ci_dir, "diff_matrix-CI-wil.csv"), quote = FALSE, row.names = TRUE)
write.csv(matrix.jeff, file.path(ci_dir, "diff_matrix-CI-jeff.csv"), quote = FALSE, row.names = TRUE)

# Excerpt for testing
head(matrix.wil)
head(matrix.jeff)

```

## 4.Heatmap Visualization
Create heatmaps to visualize pairwise differences in prevalence.

Details:

    Two heatmaps are generated: one highlighting non-overlapping CIs, one without.
    Species labels are colored based on prevalence quantiles (top 25%, bottom 25%).
    Objects used in plotting (pairwise_data.end, my_labels_colored) are saved.
    
```{r plot_CI, fig.height=10, fig.width=15, message=FALSE, warning=FALSE, dev='png', dpi=320, paged.print=TRUE}

# 4. HEATMAP VISUALIZATION ------------------------------------------------------
# Prepare species labels for the heatmap
my_labels <- unique(pairwise_data.wil$species2)

# Calculate prevalence quantiles
top_cancer_quantile_mp <- quantile(cancer_traits_processed$malignant_prevalence, 0.75, na.rm = TRUE)
bottom_cancer_quantile_mp <- quantile(cancer_traits_processed$malignant_prevalence, 0.25, na.rm = TRUE)
top_cancer_quantile_np <- quantile(cancer_traits_processed$neoplasia_prevalence, 0.75, na.rm = TRUE)
bottom_cancer_quantile_np <- quantile(cancer_traits_processed$neoplasia_prevalence, 0.25, na.rm = TRUE)

# Identify species in top and bottom quantiles
lab_top_mp <- cancer_traits_processed$species[cancer_traits_processed$malignant_prevalence >= top_cancer_quantile_mp]
lab_bottom_mp <- cancer_traits_processed$species[cancer_traits_processed$malignant_prevalence <= bottom_cancer_quantile_mp]
lab_top_np <- cancer_traits_processed$species[cancer_traits_processed$neoplasia_prevalence >= top_cancer_quantile_np]
lab_bottom_np <- cancer_traits_processed$species[cancer_traits_processed$neoplasia_prevalence <= bottom_cancer_quantile_np]

# Create colored labels based on quantile categories
color_map <- list(
  "Top MP & NP" = "#D73027",
  "Bottom MP & NP" = "#1A9850",
  "Top MP only" = "#FC8D59",
  "Bottom MP only" = "#91CF60",
  "Top NP only" = "#FEE08B",
  "Bottom NP only" = "#3288BD"
)

my_labels_colored <- sapply(my_labels, function(x) {
  if (x %in% lab_top_mp & x %in% lab_top_np) {
    paste0("<span style='color:", color_map[["Top MP & NP"]], ";'>", x, "</span>")
  } else if (x %in% lab_bottom_mp & x %in% lab_bottom_np) {
    paste0("<span style='color:", color_map[["Bottom MP & NP"]], ";'>", x, "</span>")
  } else if (x %in% lab_top_mp & x %in% lab_bottom_np) {
    paste0(
      "<span style='color:", color_map[["Top MP only"]], ";'>", substr(x, 1, nchar(x)/2), "</span>",
      "<span style='color:", color_map[["Bottom NP only"]], ";'>", substr(x, nchar(x)/2 + 1, nchar(x)), "</span>"
    )
  } else if (x %in% lab_bottom_mp & x %in% lab_top_np) {
    paste0(
      "<span style='color:", color_map[["Bottom MP only"]], ";'>", substr(x, 1, nchar(x)/2), "</span>",
      "<span style='color:", color_map[["Top NP only"]], ";'>", substr(x, nchar(x)/2 + 1, nchar(x)), "</span>"
    )
  } else if (x %in% lab_top_mp) {
    paste0("<span style='color:", color_map[["Top MP only"]], ";'>", x, "</span>")
  } else if (x %in% lab_bottom_mp) {
    paste0("<span style='color:", color_map[["Bottom MP only"]], ";'>", x, "</span>")
  } else if (x %in% lab_top_np) {
    paste0("<span style='color:", color_map[["Top NP only"]], ";'>", x, "</span>")
  } else if (x %in% lab_bottom_np) {
    paste0("<span style='color:", color_map[["Bottom NP only"]], ";'>", x, "</span>")
  } else {
    x
  }
})

# Define the categories and colors
legend_df <- tibble(
  category = names(color_map),
  color = unlist(color_map)
)

legend_plot <- ggplot(legend_df, aes(x = 1, y = category, color = category)) +
  geom_point(size = 0) +
  scale_color_manual(
    values = setNames(legend_df$color, legend_df$category),
    guide = guide_legend(override.aes = list(size = 5))
  ) +
  labs(color = "CategorÃ­as de prevalencia") +
  theme_void() +
  theme(
    legend.position = "right",
    legend.title   = element_text(size = 12),
    legend.text    = element_text(size = 10)
  )


# Save colored labels
write.csv(my_labels_colored, file.path(ci_dir, "my_labels_colored.csv"), quote = FALSE, row.names = TRUE)

# Heatmap with non-overlapping CI highlights
p_heatmap <- function(x, name) {
  p <- ggplot(x, aes(x = species2, y = species1, fill = abs(diff_value))) +
    geom_tile(color = "black", size = 0.25) +
    geom_tile(data = filter(x, !overlap_use), fill = NA, color = "black", size = 1.5) +
    geom_text(aes(label = sprintf("%.2f", abs(diff_value))), size = 3) +
    scale_fill_gradient(low = "white", high = "salmon3", name = "Difference") +
    scale_x_discrete(labels = my_labels_colored) +
    scale_y_discrete(labels = my_labels_colored) +
    theme_minimal() +
    labs(x = "Species", y = "Species",
         title = paste("Pairwise Differences in Prevalence with non-overlapping CIs (", name, ")", sep = ""),
         caption = "Upper left: neoplasia differences.\nLower right: malignant differences.\nBold border: non-overlapping CIs.") +
    theme(axis.text.x = element_markdown(angle = 45, hjust = 1),
          axis.text.y = element_markdown(angle = 0),
          panel.grid = element_blank(),
          legend.position = "none") 
  p_final <- p + legend_plot +
    plot_layout(ncol = 2, widths = c(1000,1))
  }

p_wil <- p_heatmap(pairwise_data.wil, "Wilson")
p_jeff <- p_heatmap(pairwise_data.jeff, "Jeffrey's")

# Heatmap without CI highlights
p1_heatmap <- function(x, name) {
  p <- ggplot(x, aes(x = species2, y = species1, fill = abs(diff_value))) +
    geom_tile(color = "black", size = 0.25) +
    geom_text(aes(label = sprintf("%.2f", abs(diff_value))), size = 3) +
    scale_fill_gradient(low = "white", high = "salmon3", name = "Difference") +
    scale_x_discrete(labels = my_labels_colored) +
    scale_y_discrete(labels = my_labels_colored) +
    theme_minimal() +
    labs(x = "Species", y = "Species",
         title = paste("Pairwise Differences in Prevalence (", name, ")", sep = ""),
         caption = "Upper left: neoplasia differences.\nLower right: malignant differences.") +
    theme(axis.text.x = element_markdown(angle = 45, hjust = 1),
          axis.text.y = element_markdown(angle = 0),
          panel.grid = element_blank(),
          legend.position = "none")
  p_final <- p + legend_plot +
    plot_layout(ncol = 2, widths = c(1000,1))
  }

p1_wil <- p1_heatmap(pairwise_data.wil, "Wilson")

# Save the heatmaps
ggsave(file.path(ci_dir, "visual_matrix_no_overlap-wil.png"), p_wil, width = 15, height = 12, dpi = "retina")
ggsave(file.path(ci_dir, "visual_matrix_no_overlap-jeff.png"), p_jeff, width = 15, height = 12, dpi = "retina")
ggsave(file.path(ci_dir, "visual_matrix-wil.png"), p1_wil, width = 15, height = 12, dpi = "retina")

# Excerpt for testing
p1_wil
p_wil
p_jeff

```

## 5.Polished Tables Preparation
Create readable tables for cancer traits and pairwise data.

Details:

    Rounds prevalence values and formats CIs for clarity.
    Saves polished tables as CSV files.
    
```{r polished_tables}

# 5. POLISHED TABLES PREPARATION ------------------------------------------------------
# Polished table for cancer traits
cancer_traits_ci_polished <- cancer_traits_ci %>%
  mutate(
    malignant_prevalence = round(malignant_prevalence, 3),
    neoplasia_prevalence = round(neoplasia_prevalence, 3)
  ) %>%
  select(species, adult_necropsy_count, neoplasia_necropsy, malignant_prevalence, neoplasia_prevalence, 
         malignant_CI.wil, malignant_CI.jeff, neoplasia_CI.wil, neoplasia_CI.jeff) %>%
  dplyr::rename(
    "Malignant Prevalence" = malignant_prevalence,
    "Malignant CI Wilson" = malignant_CI.wil,
    "Malignant CI Jeffrey" = malignant_CI.jeff,
    "Neoplasia Prevalence" = neoplasia_prevalence,
    "Neoplasia CI Wilson" = neoplasia_CI.wil,
    "Neoplasia CI Jeffrey" = neoplasia_CI.jeff
  )

# Save polished cancer traits table
write.csv(cancer_traits_ci_polished, file.path(ci_dir, "cancer_traits_CI_polished.csv"), quote = FALSE, row.names = FALSE)

# Polished table for pairwise data
pairwise_data_end_polished <- pairwise_data %>%
  mutate(
    malignant_diff = abs(malignant_prevalence1 - malignant_prevalence2),
    neoplasia_diff = abs(neoplasia_prevalence1 - neoplasia_prevalence2)
  ) %>%
  select(species1, species2, malignant_diff, 
         malignant_CI_lb.wil1, malignant_CI_ub.wil1, malignant_CI_lb.wil2, malignant_CI_ub.wil2,
         malignant_CI_lb.jeff1, malignant_CI_ub.jeff1, malignant_CI_lb.jeff2, malignant_CI_ub.jeff2,
         neoplasia_diff, neoplasia_CI_lb.wil1, neoplasia_CI_ub.wil1, neoplasia_CI_lb.wil2, neoplasia_CI_ub.wil2,
         neoplasia_CI_lb.jeff1, neoplasia_CI_ub.jeff1, neoplasia_CI_lb.jeff2, neoplasia_CI_ub.jeff2) %>%
  mutate(
    malignant_diff = round(malignant_diff, 3),
    neoplasia_diff = round(neoplasia_diff, 3),
    malignant_CI1.wil = paste0("[", round(malignant_CI_lb.wil1, 2), "-", round(malignant_CI_ub.wil1, 2), "]"),
    malignant_CI2.wil = paste0("[", round(malignant_CI_lb.wil2, 2), "-", round(malignant_CI_ub.wil2, 2), "]"),
    neoplasia_CI1.wil = paste0("[", round(neoplasia_CI_lb.wil1, 2), "-", round(neoplasia_CI_ub.wil1, 2), "]"),
    neoplasia_CI2.wil = paste0("[", round(neoplasia_CI_lb.wil2, 2), "-", round(neoplasia_CI_ub.wil2, 2), "]"),
    malignant_CI1.jeff = paste0("[", round(malignant_CI_lb.jeff1, 2), "-", round(malignant_CI_ub.jeff1, 2), "]"),
    malignant_CI2.jeff = paste0("[", round(malignant_CI_lb.jeff2, 2), "-", round(malignant_CI_ub.jeff2, 2), "]"),
    neoplasia_CI1.jeff = paste0("[", round(neoplasia_CI_lb.jeff1, 2), "-", round(neoplasia_CI_ub.jeff1, 2), "]"),
    neoplasia_CI2.jeff = paste0("[", round(neoplasia_CI_lb.jeff2, 2), "-", round(neoplasia_CI_ub.jeff2, 2), "]")
  ) %>%
  select(species1, species2, malignant_diff, malignant_CI1.wil, malignant_CI1.jeff, malignant_CI2.wil, malignant_CI2.jeff, neoplasia_diff, neoplasia_CI1.wil, neoplasia_CI1.jeff, neoplasia_CI2.wil, neoplasia_CI2.jeff) %>%
  dplyr::rename(
    "Malignant Difference" = malignant_diff,
    "Malignant CI1 Wilson" = malignant_CI1.wil,        
    "Malignant CI1 Jeffrey" = malignant_CI1.jeff,
    "Malignant CI2 Wilson" = malignant_CI2.wil,
    "Malignant CI2 Jeffrey" = malignant_CI2.jeff,
    "Neoplasia Difference" = neoplasia_diff,
    "Neoplasia CI1 Wilson" = neoplasia_CI1.wil,
    "Neoplasia CI1 Jeffrey" = neoplasia_CI1.jeff,
    "Neoplasia CI2 Wilson" = neoplasia_CI2.wil,
    "Neoplasia CI2 Jeffrey" = neoplasia_CI2.jeff
  )

# Save polished pairwise table
write.csv(pairwise_data_end_polished, file.path(ci_dir, "pairwise_data_end_polished.csv"), quote = FALSE, row.names = FALSE)

# Excerpt for testing
head(cancer_traits_ci_polished)

```

